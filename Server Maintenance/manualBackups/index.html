<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Manual Backups | OneArmy Community Platform</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://onearmy.github.io/community-platform/community-platform/Server Maintenance/manualBackups"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Manual Backups | OneArmy Community Platform"><meta data-react-helmet="true" name="description" content="In order to fully backup the platform there are 3 areas that need to be backed up:"><meta data-react-helmet="true" property="og:description" content="In order to fully backup the platform there are 3 areas that need to be backed up:"><link data-react-helmet="true" rel="shortcut icon" href="/community-platform/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://onearmy.github.io/community-platform/community-platform/Server Maintenance/manualBackups"><link data-react-helmet="true" rel="alternate" href="https://onearmy.github.io/community-platform/community-platform/Server Maintenance/manualBackups" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://onearmy.github.io/community-platform/community-platform/Server Maintenance/manualBackups" hreflang="x-default"><link rel="stylesheet" href="/community-platform/assets/css/styles.7ae3f653.css">
<link rel="preload" href="/community-platform/assets/js/runtime~main.9873ddc6.js" as="script">
<link rel="preload" href="/community-platform/assets/js/main.d6dd3a8b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/community-platform/"><img src="/community-platform/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/community-platform/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">OneArmy Community Platform</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/community-platform/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ONEARMY/community-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">How To Contribute</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Frontend Development</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Backend Development</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Testing</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Advanced Guides</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Continuous Integration</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Server Maintenance</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/community-platform/Server Maintenance/dataMigration">Automated Backup and Migration</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/community-platform/Server Maintenance/manualBackups">Manual Backups</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/community-platform/Environmental Impact/environmental-impact">Environmental Impact</a></li></ul></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/community-platform/Security">Security</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Manual Backups</h1></header><p>In order to fully backup the platform there are 3 areas that need to be backed up:</p><ol><li><p>Firestore Database
<a href="https://console.cloud.google.com/firestore/import-export?project=onearmyworld" target="_blank" rel="noopener noreferrer">https://console.cloud.google.com/firestore/import-export?project=onearmyworld</a></p><p>Use in interactive export tool to create a backup of the database. If the data is simply for re-importing later the entire database can be selected. If only some specific data collections are likely to be imported, or tools like bigquery will be used to analyse the exported data then individual collections should be specified (e.g. <code>v3_howtos</code>)</p><p><img src="/community-platform/assets/images/firestore-backup-1-533178e0157316bc3f68bd140b8e4a77.png"></p><p>The backup can be made to the existing <code>onearmyworld-exports</code> bucket, or a personal storage bucket. Exports should be named in a consistent way, prefixed with a timestamp (<code>yyyy-mm-dd</code>)</p><p>The backup can also be downloaded locally using the <a href="https://cloud.google.com/storage/docs/gsutil" target="_blank" rel="noopener noreferrer">gsutil</a> tool</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gsutil cp -r gs://onearmyworld-exports/name-of-backup ./my-local-backup-folder</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Firebase Storage
This is a bucket in firebase cloud storage, and so can be handled in a similar way to the firestore database, via the gcloud console</p><p><img src="/community-platform/assets/images/firestore-backup-2-8c9013a546820b0de1046fb0ff874581.png"></p><p>Additionally, files can be downloaded to backup locally or to another storage provider via <a href="https://cloud.google.com/storage/docs/gsutil" target="_blank" rel="noopener noreferrer">gsutil</a> run from a local command line, e.g.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gsutil cp -r \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">gs://onearmyworld.appspot.com/uploads \</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">./my-local-backup-folder</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Firbase Auth Users<br>
See documentation: <a href="https://firebase.google.com/docs/cli/auth" target="_blank" rel="noopener noreferrer">https://firebase.google.com/docs/cli/auth</a></p></li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="importing-data-from-a-backup"></a>Importing Data from a Backup<a class="hash-link" href="#importing-data-from-a-backup" title="Direct link to heading">#</a></h2><p>The same graphical interface can be used to import data. However care should be taken before importing in case of unintended side-effects.</p><p>Specifically firebase functions should first be disabled and data may need to first be deleted from the target project.</p><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</h5></div><div class="admonition-content"><p>If functions are triggered on database changes they will be triggered for every document that is imported</p></div></div><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>When importing a collection any existing data will be merged with the import.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="migrateclone"></a>Migrate/Clone<a class="hash-link" href="#migrateclone" title="Direct link to heading">#</a></h2><p>In order to migrate the data to another server similar steps must be taken and permissions</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="service-worker"></a>Service worker<a class="hash-link" href="#service-worker" title="Direct link to heading">#</a></h2><ul><li>activate required api: <a href="https://console.cloud.google.com/apis/api/cloudresourcemanager.googleapis.com" target="_blank" rel="noopener noreferrer">https://console.cloud.google.com/apis/api/cloudresourcemanager.googleapis.com</a></li><li>creating</li><li>permissions (easiest to assign as viewer for source, and datastore import/export target)<ul><li>Source firestore - viewer</li><li>Target firestore - viewer, datastore import/export</li><li>Storage bucket - storage admin</li><li>Service Account User</li></ul></li><li><a href="https://cloud.google.com/firestore/docs/security/iam#roles" target="_blank" rel="noopener noreferrer">https://cloud.google.com/firestore/docs/security/iam#roles</a></li><li><a href="https://cloud.google.com/iam/docs/granting-changing-revoking-access" target="_blank" rel="noopener noreferrer">https://cloud.google.com/iam/docs/granting-changing-revoking-access</a></li><li><ul><li>Check</li></ul></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gcloud projects list</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">gcloud auth list</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ONEARMY/community-platform/edit/master/documentation/docs/Server Maintenance/manual-backups.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/community-platform/Server Maintenance/dataMigration"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Automated Backup and Migration</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/community-platform/Environmental Impact/environmental-impact"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#importing-data-from-a-backup" class="table-of-contents__link">Importing Data from a Backup</a></li><li><a href="#migrateclone" class="table-of-contents__link">Migrate/Clone</a></li><li><a href="#service-worker" class="table-of-contents__link">Service worker</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/community-platform/">Style Guide</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/up3nBbEbxY" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/ONEARMY/community-platform" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021</div></div></div></footer></div>
<script src="/community-platform/assets/js/runtime~main.9873ddc6.js"></script>
<script src="/community-platform/assets/js/main.d6dd3a8b.js"></script>
</body>
</html>